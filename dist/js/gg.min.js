/*!
 * Gentle Guide v1.0.1
 * Copyright (c) 2020 Dariel Vicedo <dariel@devmanextensions.com> (https://devmanextensions.com)
 * Licensed under ISC (https://github.com/devmanextensions/gentle-guide/blob/master/LICENSE)
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).GGuide=e()}(this,(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o=function(){function e(n,i,o){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t(this,e);var r={showPrev:!0,canFinish:!0};this.anchor=n,this.position=i,this.content=o,this.options=Object.assign({},r,s),this.element=this.createElement()}return n(e,[{key:"getElement",value:function(){return this.element}},{key:"createElement",value:function(){var t=document.createElement("div");t.className="gg-card";var e=document.createElement("div");e.className="gg-card-content",e.innerHTML=this.content;var n=document.createElement("div");n.className="gg-card-footer";var i=document.createElement("div");i.className="gg-card-footer-left";var o=document.createElement("div");o.className="gg-card-footer-center";var s=document.createElement("div");if(s.className="gg-card-footer-right",n.append(i),n.append(o),n.append(s),this.options.showPrev){var r=document.createElement("a");r.setAttribute("role","button"),r.textContent="<< prev",r.addEventListener("click",this.options.onPrev,!1),i.append(r)}if(this.options.canFinish){var a=document.createElement("a");a.setAttribute("role","button"),a.className="gg-card-action-finish",a.textContent="end it now",a.addEventListener("click",this.options.onFinish,!1),o.append(a)}var h=document.createElement("a");h.setAttribute("role","button"),h.className="gg-card-action-next",h.textContent="Got it!",h.addEventListener("click",this.options.onNext,!1),s.append(h);var c=document.createElement("div");return c.className="gg-card-arrow",t.append(e),t.append(n),t.append(c),t}},{key:"getAnchorCoordinates",value:function(){var t=this.anchor.getBoundingClientRect();return{top:t.top+window.pageYOffset,left:t.left+window.pageXOffset}}},{key:"setCardInPosition",value:function(){var t=this.getAnchorCoordinates();switch(this.position){case"top":default:this.element.className+=" gg-card-top",this.element.style.left=t.left-this.element.offsetWidth/2+this.anchor.offsetWidth/2+"px",this.element.style.top=t.top-this.element.offsetHeight-15+"px";break;case"right":this.element.className+=" gg-card-right",this.element.style.left=t.left+this.anchor.offsetWidth+15+"px",this.element.style.top=t.top-this.element.offsetHeight/2+this.anchor.offsetHeight/2+"px";break;case"bottom":this.element.className+=" gg-card-bottom",this.element.style.left=t.left-this.element.offsetWidth/2+this.anchor.offsetWidth/2+"px",this.element.style.top=t.top+this.anchor.offsetHeight+15+"px";break;case"left":this.element.className+=" gg-card-left",this.element.style.left=t.left-this.element.offsetWidth-15+"px",this.element.style.top=t.top-this.element.offsetHeight/2+this.anchor.offsetHeight/2+"px"}}}]),e}();return function(){function e(n){var o=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(this,e),i(this,"onNext",(function(){o.showNext()})),i(this,"onPrev",(function(){o.showPrev()})),i(this,"onFinish",(function(){o.end()}));var r={firstCard:0,showPrev:!0,canFinish:!0};return this.options=Object.assign({},r,s),this.currentStep="string"==typeof this.options.firstCard?parseInt(this.options.firstCard,10):this.options.firstCard,this.steps=this.createSteps(n),this.onNext=this.onNext.bind(this),this.onPrev=this.onPrev.bind(this),this.onFinish=this.onFinish.bind(this),this}return n(e,[{key:"createSteps",value:function(t){for(var e=[],n=0;n<t.length;n++){var i=this.getAnchor(t[n].selector);if(i){var s={};s.anchor=i,s.position=t[n].position,s.content=t[n].content,s.prev=e&&e.length?e[e.length-1]:null,s.next=null,null!==s.prev&&(s.prev.next=s);var r="undefined"!=typeof t[n].options?t[n].options:{},a="undefined"==typeof r.canFinish||r.canFinish,h={showPrev:!!this.options.showPrev&&null!==s.prev,canFinish:!!this.options.canFinish&&a,cardStep:n,onNext:this.onNext,onPrev:this.onPrev,onFinish:this.onFinish},c=Object.assign({},h,t[n].options),p=new o(s.anchor,s.position,s.content,c);s.card=p,e.push(s)}else console.warn("GGuide: The card with selector '"+t[n].selector+"' was ignored since no DOM element was found.")}return e}},{key:"begin",value:function(){return this.drawStep(this.steps[this.currentStep]),this}},{key:"end",value:function(){return this.removeStep(this.steps[this.currentStep]),this.currentStep=this.options.firstCard,"undefined"!=typeof this.options.onFinish&&"function"==typeof this.options.onFinish&&this.options.onFinish(),this}},{key:"showNext",value:function(){var t=this.steps[this.currentStep];if(null!==this.steps[this.currentStep].next){var e=this.currentStep+=1;this.removeStep(t),this.drawStep(t.next),this.currentStep=e,"undefined"!=typeof this.options.onNext&&"function"==typeof this.options.onNext&&this.options.onNext(e),"undefined"!=typeof this.options.onChange&&"function"==typeof this.options.onChange&&this.options.onChange(e)}else this.end()}},{key:"showPrev",value:function(){var t=this.steps[this.currentStep];if(null!==this.steps[this.currentStep].prev){var e=this.currentStep-=1;this.removeStep(t),this.drawStep(t.prev),this.currentStep=e,"undefined"!=typeof this.options.onPrev&&"function"==typeof this.options.onPrev&&this.options.onPrev(e),"undefined"!=typeof this.options.onChange&&"function"==typeof this.options.onChange&&this.options.onChange(e)}}},{key:"drawStep",value:function(t){t.anchor.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),document.body.append(t.card.getElement()),t.card.setCardInPosition()}},{key:"removeStep",value:function(t){t.card.getElement().remove()}},{key:"getAnchor",value:function(t){var e=document.querySelector(t);return"undefined"!=typeof e&&null!=e&&e}}]),e}()}));